<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<title>ê·¸ë¦¿ì—ë“€ í•™ìƒë³„ ê°•ì˜ JSON ìƒì„±ê¸° (ê´€ë¦¬ììš©)</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body { font-family: system-ui, sans-serif; max-width: 1000px; margin: 20px auto; padding: 0 20px; }
h1 { margin-bottom: 8px; }
table { width: 100%; border-collapse: collapse; margin-top: 12px; }
th, td { border: 1px solid #ccc; padding: 6px 8px; text-align: left; font-size: 14px; }
th { background: #f9f9f9; }
input, textarea { font: inherit; }
textarea { width: 100%; height: 60px; resize: vertical; }
button { font: inherit; padding: 6px 10px; margin: 4px; border-radius: 6px; cursor: pointer; }
button.primary { background: #ff7a00; color: white; border: 1px solid #ff7a00; }
button.danger { background: #e74c3c; color: white; border: 1px solid #c0392b; }
#controls { display:flex; flex-wrap:wrap; gap:6px; margin-bottom:10px; }
pre { background:#f7f7f7; padding:10px; border-radius:8px; overflow:auto; font-size:13px; }
.note { color:#666; font-size:13px; }
</style>
</head>
<body>

  <header class="grit-header fixed" aria-label="Site header">
    <div class="grit-header__wrap">
      <a class="grit-logo" href="/" aria-label="ê·¸ë¦¿ì—ë“€ í™ˆ">
        <img src="/assets/logo.png" alt="ê·¸ë¦¿ì—ë“€" />
      </a>
      <nav class="grit-nav" aria-label="ì£¼ ë©”ë‰´">
        <ul>
          <li><a href="/">ê·¸ë¦¿ì—ë“€</a></li>
          <li><a href="/story.html">ì´ì•¼ê¸°</a></li>
          <li><a href="/instructors.html">ê°•ì‚¬ì§„</a></li>
          <li><a href="/gallery.html">ê°¤ëŸ¬ë¦¬</a></li>
          <li><a href="/contact.html">ë¬¸ì˜</a></li>
          <li><a href="/members/dashboard.html" id="menu-myclass" style="display:none;">ë‚´ ê°•ì˜ì‹¤</a></li>
          <li><a href="/login.html" id="menu-login">ë¡œê·¸ì¸</a></li>
          <li><a href="#" id="menu-logout" style="display:none;">ë¡œê·¸ì•„ì›ƒ</a></li>
        </ul>
      </nav>
      <button class="menu-toggle" id="menuToggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
        <span></span><span></span><span></span>
      </button>
    </div>
  </header>

  <div style="margin-top: 64px;">

<h1>ğŸ“š GRIT EDU í•™ìƒë³„ ê°•ì˜ JSON ìƒì„±ê¸°</h1>
<p class="note">ë¸Œë¼ìš°ì €ë§Œìœ¼ë¡œ í•™ìƒ ëª…ë‹¨ì„ ê´€ë¦¬í•˜ê³ , ê° í•™ìƒë³„ JSONì„ ìë™ ìƒì„±Â·ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div id="controls">
  <button id="addStudent">í•™ìƒ ì¶”ê°€</button>
  <button id="exportJSON" class="primary">ì „ì²´ JSON ZIP ë‹¤ìš´ë¡œë“œ</button>
  <button id="exportCSV">CSV(ì—‘ì…€) ë‚´ë³´ë‚´ê¸°</button>
  <button id="clearAll" class="danger">ì „ì²´ ì´ˆê¸°í™”</button>
</div>

<table id="table">
  <thead>
    <tr>
      <th>ì´ë¦„</th>
      <th>ì´ë©”ì¼(ì•„ì´ë””)</th>
      <th>ë¹„ê³ </th>
      <th>ê°•ì˜ ëª©ë¡<br><small>í•œ ì¤„ë‹¹ "ì œëª© | videoId"</small></th>
      <th>ì‚­ì œ</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<pre id="preview"></pre>

<script type="module">
import JSZip from "https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm";
const tableBody = document.querySelector("#table tbody");
const preview = document.getElementById("preview");

function loadData() {
  return JSON.parse(localStorage.getItem("grit_students") || "[]");
}
function saveData(data) {
  localStorage.setItem("grit_students", JSON.stringify(data));
  repaint();
}
function repaint() {
  const data = loadData();
  tableBody.innerHTML = "";
  data.forEach((s, i) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td><input value="${s.name||""}" data-field="name" data-idx="${i}" placeholder="í™ê¸¸ë™"></td>
      <td><input value="${s.email||""}" data-field="email" data-idx="${i}" placeholder="ì•„ì´ë””ë§Œ ì…ë ¥ (ì˜ˆ: student1)">@gmail.com</td>
      <td><input value="${s.note||""}" data-field="note" data-idx="${i}" placeholder="ë¹„ê³ "></td>
      <td><textarea data-field="courses" data-idx="${i}" placeholder="ì˜ˆ) ë§›ë³´ê¸° 1 | 6aPYStft9Xo"></textarea></td>
      <td><button data-del="${i}" style="background:#f66;color:white;border:none;border-radius:6px;">X</button></td>
    `;
    tableBody.appendChild(tr);
    tr.querySelector("textarea").value = s.rawCourses || "";
  });
  preview.textContent = JSON.stringify(data, null, 2);
}
tableBody.addEventListener("input", e => {
  const f = e.target.dataset.field;
  const idx = Number(e.target.dataset.idx);
  const data = loadData();
  if (!data[idx]) return;
  data[idx][f] = e.target.value;
  if (f === "courses") data[idx].rawCourses = e.target.value;
  saveData(data);
});
tableBody.addEventListener("click", e => {
  const idx = e.target.dataset.del;
  if (idx !== undefined) {
    const data = loadData();
    data.splice(idx, 1);
    saveData(data);
  }
});

document.getElementById("addStudent").onclick = () => {
  const data = loadData();
  data.push({ name: "", email: "", note: "", rawCourses: "" });
  saveData(data);
};

document.getElementById("clearAll").onclick = () => {
  if (confirm("ëª¨ë“  í•™ìƒ ë°ì´í„°ë¥¼ ì‚­ì œí• ê¹Œìš”?")) {
    localStorage.removeItem("grit_students");
    repaint();
  }
};

// ===== JSON / CSV ìƒì„± =====
function makeJSON(student) {
  const emailFull = (student.email||"").trim().toLowerCase() + "@gmail.com";
  const items = (student.rawCourses||"")
    .split(/\n+/)
    .map(line => {
      const [t, vid] = line.split("|").map(s=>s.trim());
      return (t && vid) ? { title:t, videoId:vid } : null;
    })
    .filter(Boolean);
  return {
    name: student.name,
    email: emailFull,
    note: student.note,
    courses: [{ title:"ì½”ìŠ¤", items }]
  };
}

// ===== ZIP ë‹¤ìš´ë¡œë“œ =====
document.getElementById("exportJSON").onclick = async () => {
  const zip = new JSZip();
  const data = loadData();
  if (!data.length) return alert("í•™ìƒ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
  for (const s of data) {
    const json = makeJSON(s);
    const fname = (s.name||s.email||"student") + ".json";
    zip.file(fname, JSON.stringify(json, null, 2));
  }
  const blob = await zip.generateAsync({ type:"blob" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "grit_students.zip";
  a.click();
  URL.revokeObjectURL(a.href);
};

// ===== CSV ë‚´ë³´ë‚´ê¸° =====
document.getElementById("exportCSV").onclick = () => {
  const data = loadData();
  if (!data.length) return alert("í•™ìƒ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
  const rows = [["ì´ë¦„","ì´ë©”ì¼(@gmail.com)","ë¹„ê³ ","ê°•ì˜ëª©ë¡"]];
  for (const s of data) {
    rows.push([
      s.name,
      (s.email||"")+"@gmail.com",
      s.note,
      (s.rawCourses||"").replace(/\n/g," / ")
    ]);
  }
  const csv = rows.map(r => r.map(v=>`"${(v||"").replace(/"/g,'""')}"`).join(",")).join("\n");
  const blob = new Blob([csv], { type: "text/csv" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "grit_students.csv";
  a.click();
  URL.revokeObjectURL(a.href);
};

// ì´ˆê¸° ë Œë”
repaint();
</script>

  <footer class="grit-footer" style="margin-top:40px;border-top:1px solid #eee;background:#fff;">
    <div class="grit-footer-inner" style="max-width:1080px;margin:0 auto;padding:20px 16px;text-align:center;">
      <div class="grit-footer-sns" style="display:flex;justify-content:center;gap:16px;margin-bottom:8px;">
        <a href="https://www.instagram.com/grit_edu_seoul/" target="_blank" rel="noopener" aria-label="Instagram" class="sns" style="opacity:.85;">
          <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
            <rect x="2" y="2" width="20" height="20" rx="5" fill="#222"></rect>
            <circle cx="12" cy="12" r="5.2" fill="#fff"></circle>
            <circle cx="12" cy="12" r="3.8" fill="#222"></circle>
            <circle cx="17.5" cy="6.5" r="1" fill="#fff"></circle>
          </svg>
        </a>
        <a href="https://www.youtube.com/@gritedu_official" target="_blank" rel="noopener" aria-label="YouTube" class="sns" style="opacity:.85;">
          <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
            <rect x="2" y="2" width="20" height="20" rx="5" fill="#222"></rect>
            <polygon points="10,8 16,12 10,16" fill="#fff"></polygon>
          </svg>
        </a>
        <a href="https://blog.naver.com/gritedu" target="_blank" rel="noopener" aria-label="Naver Blog" class="sns" style="opacity:.85;">
          <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
            <rect x="2" y="2" width="20" height="20" rx="5" fill="#222"></rect>
            <path d="M8 7h2.6l3 4.3V7H16v10h-2.6L10.4 12v5H8Z" fill="#fff"></path>
          </svg>
        </a>
      </div>
      <p style="margin:4px 0;color:#333;">Â© 2025 ê·¸ë¦¿ì—ë“€ | ì„œìš¸ ê¸ˆì²œêµ¬ ì‹œí¥ëŒ€ë¡œ47ê¸¸ 28-5 ë‚¨ì„œìš¸êµìœ¡ë¬¸í™”ì„¼í„° 5ì¸µ</p>
      <p style="margin:4px 0;color:#333;">Tel : 02-809-0611</p>
    </div>
  </footer>

  <!-- ê³µí†µ UI -->
  <script type="module" src="/assets/js/common.js"></script>
